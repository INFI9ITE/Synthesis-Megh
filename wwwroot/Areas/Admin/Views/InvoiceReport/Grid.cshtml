@model IEnumerable<wwwroot.Areas.Admin.Models.Invoice_Select>
@using wwwroot.Areas.Admin.Models
@using wwwrootBL.Entity;
@{
    Layout = null;
    WestZoneEntities db = new WestZoneEntities();
}

<style>
    .divIDClass {
        z-index: 999999 !important;
    }
</style>
<div id="grddata">
    <div class="animate-panelmessesgarea padbtmzero">

        @if (ViewBag.StatusMessage.ToString() == "SuccessEdit")
        {
            <script>

                toastr.options = {
                    "closeButton": true,
                    "debug": false,
                    "newestOnTop": false,
                    "progressBar": false,
                    "positionClass": "toast-top-right",
                    "preventDuplicates": false,
                    "onclick": null,
                    "showDuration": "3000",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "10000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                }

                toastr.success('Invoice Updated Successfully.');
            </script>
        }
        @if (ViewBag.StatusMessage.ToString() == "Success")
        {
            <script>
                toastr.options = {
                    "closeButton": true,
                    "debug": false,
                    "newestOnTop": false,
                    "progressBar": false,
                    "positionClass": "toast-top-right",
                    "preventDuplicates": false,
                    "onclick": null,
                    "showDuration": "3000",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "10000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                }

                toastr.success('Invoice created Successfully.');
            </script>
        }
        @if (ViewBag.StatusMessage.ToString() == "Delete")
        {
            <script>
                toastr.options = {
                    "closeButton": true,
                    "debug": false,
                    "newestOnTop": false,
                    "progressBar": false,
                    "positionClass": "toast-top-right",
                    "preventDuplicates": false,
                    "onclick": null,
                    "showDuration": "3000",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "10000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                }
                toastr.success('Invoice deleted Successfully');
            </script>
        }
        @if (ViewBag.StatusMessage.ToString() == "Edit")
        {
            <script>
                toastr.options = {
                    "closeButton": true,
                    "debug": false,
                    "newestOnTop": false,
                    "progressBar": false,
                    "positionClass": "toast-top-right",
                    "preventDuplicates": false,
                    "onclick": null,
                    "showDuration": "3000",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "10000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                }

                toastr.success('Invoice updated Successfully');
            </script>
        }
        @if (ViewBag.StatusMessage.ToString() == "Error")
        {
            <script>
                MyfunError();
            </script>
        }
        @if (ViewBag.StatusMessage.ToString() == "NoItem")
        {
            <script>
                MyfunNoItem();
            </script>
        }
        @if (ViewBag.StatusMessage.ToString() == "Exists")
        {
            <script>
                MyfunExists();
            </script>
        }
    </div>
    <div class="addinvoice" style="padding-top:0px!important;">
        <div class="page-body headertopbox greenbox printpadzero">
            <div class="page-header-main position-relative printarea printpadzero">
                <div class="row">
                    <div class="col-md-6 col-sm-6">
                        <h2>Reports</h2>
                    </div>
                    <div class="col-md-6 col-sm-6">
                        <div class="actionbox">
                            <a href="javascript:window.print();">
                                <img src="@Url.Content("~/Content/Admin/images/icon_print.png")" alt="" />
                            </a>
                            <a href="@Url.Action("ExportPDFData", "InvoiceReport",new {startdate = ViewBag.startdate, enddate = ViewBag.enddate, payment = ViewBag.payment, deptname = ViewBag.deptname, Status= ViewBag.Status, VendorName= @ViewBag.VendorName,AmtMaximum = @ViewBag.AmtMaximum,AmtMinimum = @ViewBag.AmtMinimum})"><img src="~/Content/Admin/images/icon_pdf.png" alt="" /></a>
                            <a href="@Url.Action("ExportExcelData", "InvoiceReport",new {startdate = ViewBag.startdate, enddate = ViewBag.enddate, payment = ViewBag.payment, deptname = ViewBag.deptname, Status= ViewBag.Status, VendorName= @ViewBag.VendorName,AmtMaximum = @ViewBag.AmtMaximum,AmtMinimum = @ViewBag.AmtMinimum})"><img src="~/Content/Admin/images/icon_excel.png" alt="" /></a>
                        </div>
                    </div>
                </div>
                <div class="reportsearch">
                    <div class="row">
                        @*<div class="col-md-12">
                                <table class="marbtm15">
                                    <td class="left-text dataTables_length showdata" style="padding-top: 0px!important;">

                                        @{
                                        List<SelectListItem>
                                            listItem_Records = new List<SelectListItem>
                                                ();
                                                string[] Records = wwwroot.Class.AdminSiteConfiguration.GetArrayForRecord().ToString().Split(',');
                                                foreach (string word in Records)
                                                {
                                                listItem_Records.Add(new SelectListItem
                                                {
                                                Text = word.Split(':')[0],
                                                Value = word.Split(':')[1]
                                                });
                                                }

                                                @Html.DropDownList("SelectRecords", listItem_Records, new { @class = "myval", @onchange = "javascript:FunPageRecord(this.value);" })
                                                }&nbsp;&nbsp;&nbsp;Records
                                    </td>
                                </table>
                            </div>*@
                        <div class="col-lg-2 col-md-3 col-sm-3">
                            <label>Filter by Payment Method</label>
                            <table>
                                <td class="pad10">
                                    <input class="chk" id="radio1" type="checkbox" name="radio" value="Cash">
                                    <label for="radio1">Cash</label>
                                </td>
                                <td>
                                    <input class="chk" id="radio2" type="checkbox" name="radio" value="Check/ACH">
                                    <label for="radio2">Check/ACH</label>
                                </td>
                            </table>
                        </div>
                        <div class="col-lg-2 col-md-3 col-sm-3">
                            <label>Filter by</label>
                            <table>
                                <tr>

                                    <td class="padright10">
                                        @*<input data-val="true" data-val-date="The field Startdate must be a date." data-val-required=" " id="Startdate" name="Startdate" placeholder="From" type="text" value="" class="datepicker form-control" />*@
                                        <input name="txtstartdate" data-val="true" data-val-date="The field Startdate must be a date." type="text" maxlength="100" id="txtstartdate" placeholder="From" class="datepicker form-control" onkeydown="return false">
                                    </td>
                                    <td>

                                        @*<input data-val="true" data-val-date="The field Startdate must be a date." data-val-required=" " id="Enddate" name="Enddate" placeholder="To" type="text" value="" class="datepicker form-control" />*@
                                        <input name="txtenddate" data-val="true" data-val-date="The field Startdate must be a date." data-val-required=" " type="text" maxlength="100" id="txtenddate" onkeydown="return false" placeholder="To" class="datepicker form-control">
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-lg-2 col-md-2 col-sm-2">
                            <label class="mob_martop10">Select Department</label>
                            @{
                                List<SelectListItem>
                                    Lstdept = new List<SelectListItem>
                                        ();
                                foreach (ddllist item in ViewBag.Datadept)
                                {
                                    Lstdept.Add(new SelectListItem
                                    {
                                        Text = item.Text,
                                        Value = Convert.ToString(item.Value)
                                    });
                                }
                            }
                            @Html.DropDownList("DrpLstdept", Lstdept, "Select Department", new { @class = "myval" })
                        </div>
                        <div class="col-lg-1 col-md-2 col-sm-2">
                            @*<input name="txtSearchTitle" type="text" maxlength="100" id="txtSearchTitle" placeholder="Invoice Number" class="form-control m-b" style="visibility:hidden;">*@
                            <label class="mob_martop10">Select Status</label>
                            @{
                                List<SelectListItem>
                                    Lststatus = new List<SelectListItem>
                                        ();
                                foreach (ddllist item in ViewBag.Datastatus)
                                {
                                    Lststatus.Add(new SelectListItem
                                    {
                                        Text = item.Text,
                                        Value = Convert.ToString(item.Value)
                                    });
                                }
                            }
                            @Html.DropDownList("Drpstatus", Lststatus, "Select Status", new { @class = "myval" })
                        </div>
                        <div class="col-lg-2 col-md-2 col-sm-2">

                            <label class="mob_martop10">Select Vendor Name</label>
                            @{
                                List<SelectListItem>
                                    VendorName = new List<SelectListItem>
                                        ();
                                foreach (ddllist item in ViewBag.VendorList)
                                {
                                    VendorName.Add(new SelectListItem
                                    {
                                        Text = item.Text,
                                        Value = Convert.ToString(item.Value)
                                    });
                                }
                            }
                            @Html.DropDownList("VendorName", VendorName, "Select Vendor Name", new { @class = "myval" })
                        </div>

                        <div class="col-lg-2 col-md-3 col-sm-3">
                            <label>Filter by Amount</label>
                            <table>
                                <tr>
                                    <td class="padright10">
                                        <input name="AmtMinimum" data-val="true" maxlength="18" type="text" id="AmtMinimum" onchange="Minimum()" placeholder="Minimum" class="form-control decimalOnly">
                                    </td>
                                    <td>
                                        <input name="AmtMaximum" data-val="true" maxlength="18" type="text" id="AmtMaximum" onchange="Maximum()" placeholder="Maximum" class="form-control decimalOnly">
                                    </td>
                                </tr>
                            </table>
                            @*<div class="highlight" id="Validation">Select Valid Amount</div>*@
                        </div>

                        <div class="col-lg-1 col-md-2 col-sm-2">
                            @*<a href="#" class="btn btn-danger btn-sm pull-right martop25">Show Report</a>*@
                            <input type="submit" name="btnSearch" value="Show Report" id="btnSearch" onclick="javascript:FunSearchRecord();" class="btn btn-danger btn-sm pull-right martop25" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="printbox printboxaarea" style="background: #f1f1f1!important;   box-shadow: 0px 4px 6px #dddddd; margin:-20px 0px 0px!important; padding:20px 0px 15px!important;">
                <h3 style="font-size:35px;">@ViewBag.StoreNamevalue</h3>
                <div class="filterfirstprint">
                    <ul>
                        @{
                            int DeptId = Convert.ToInt32(@ViewBag.deptname);
                            var startdateval = @ViewBag.startdate;
                            var Enddateval = @ViewBag.enddate;
                            var DeptName = (from data in db.tbl_Department where data.id == DeptId select data.Name).FirstOrDefault();

                        }
                        @if (!string.IsNullOrEmpty(DeptName))
                        {
                            <li style="font-size:14px;"><span style="font-size:20px;">Department </span> <br />@DeptName</li>
                        }
                        else
                        {
                            <li style="font-size:14px;"><span style="font-size:15px;">Department </span> <br />NA</li>
                        }
                        @if (!string.IsNullOrEmpty(startdateval) && !string.IsNullOrEmpty(Enddateval))
                        {
                            <li style="font-size:14px;"><span style="font-size:15px;">Date Range </span> <br />@ViewBag.startdate - @ViewBag.enddate</li>
                        }
                        else
                        {
                            <li style="font-size:14px;"><span style="font-size:15px;">Date Range </span> <br />NA</li>
                        }

                        @if (ViewBag.payment == "")
                        {
                            <li style="font-size:14px;"><span style="font-size:15px;">Payment Method </span> <br />Cash & Check/ACH</li>
                        }
                        else
                        {
                            <li style="font-size:14px;"><span style="font-size:15px;">Payment Method </span> <br />@ViewBag.payment</li>
                        }

                    </ul>
                    <ul class="marbtm40">
                        @{
                            int VendorId = Convert.ToInt32(@ViewBag.VendorName);
                            var Vendor = (from data in db.tbl_Vendor where data.id == VendorId select data.Name).FirstOrDefault();
                            if (!string.IsNullOrEmpty(Vendor))
                            {
                                <li style="font-size:14px;"><span style="font-size:15px;">Vendor Name</span><br />@Vendor</li>
                            }
                            else
                            {
                                <li style="font-size:14px;"><span style="font-size:15px;">Vendor Name</span><br />NA</li>
                            }
                            var amtmaxval = @ViewBag.AmtMaximum;
                            var amtminval = @ViewBag.AmtMinimum;


                        }
                        @if (amtmaxval > 0 || amtminval > 0)
                        {
                            <li style="font-size:14px;"><span style="font-size:15px;">Amount Range</span> <br />@ViewBag.AmtMaximum - @ViewBag.AmtMinimum</li>
                        }
                        else
                        {
                            <li style="font-size:14px;"><span style="font-size:15px;">Amount Range</span> <br />NA</li>
                        }

                        @{
                            int StatusId = Convert.ToInt32(@ViewBag.Status);
                            var StatusName = (from data in db.tbl_Status where data.id == StatusId select data.Name).FirstOrDefault();
                            if (!string.IsNullOrEmpty(StatusName))
                            {
                                <li style="font-size:14px;"><span style="font-size:15px;">Status </span> <br />@StatusName</li>
                            }
                            else
                            {
                                <li style="font-size:14px;"><span style="font-size:15px;">Status </span> <br />NA</li>
                            }
                        }

                    </ul>
                </div>
            </div>
        </div>
        @{if (Model.Count() > 0)
            {
                <div class="datagrid pad10">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th style="text-align:left"><a class="textred" onclick="javascript:FunSortData('Vendorname');" style="color:#fff; text-decoration:none; cursor:pointer;">Vendor Name</a></th>
                                    <th class="text-align-left">Invoice Type</th>
                                    <th style="text-align:left"><a class="textred" onclick="javascript:FunSortData('Invoice_Number');" style="color:#fff; text-decoration:none; cursor:pointer;">Invoice #</a></th>
                                    @{
                                        string storeid = @ViewBag.Storeidvalue;
                                    }
                                    @if (Roles.IsUserInRole("Administrator") && @storeid == "0")
                                    {
                                        <th class="text-align-center">Store Name</th>
                                    }
                                    <th class="text-align-center"><a class="textred" onclick="javascript:FunSortData('Invoice_Date');" style="color:#fff; text-decoration:none; cursor:pointer;">Invoice Date</a></th>
                                    <th style="text-align:right">Amount</th>
                                    <th class="text-align-center">Status</th>
                                    <th class="text-align-center">Payment Method</th>
                                    <th class="text-align-center">Created On</th>
                                    @*
                                        <th>Note</th>*@
                                    @if ((Roles.IsUserInRole("Administrator")) || (Roles.IsUserInRole("Back Office Manager")) || (Roles.IsUserInRole("Data Approver")))
                                    {
                                        <th class="printarea" style="display:none">Action</th>
                                    }
                                </tr>
                            </thead>
                            <tbody>
                                @{
                                    foreach (var item in Model)
                                    {

                                        <tr class="even datagrid">
                                            <td class="fntlight" style="width:22%;text-align:left">@Html.Raw(item.Vendorname)</td>
                                            <td class="fntlight" style="width:5%" class="text-align-center">@Html.Raw(item.Type)</td>
                                            @*<td class="width20">@Html.Raw(item.Vendorname)</td>*@
                                            @*<td style="width:5%" class="text-align-left">@Html.Raw(item.Type)</td>*@
                                            <td class="fntlight" style="width:7%;text-align:center"><a href="@Url.Action("Detail", "InvoiceReport" ,new { Id=item.id ,deptname = @ViewBag.deptname, startdate = @ViewBag.startdate, enddate = @ViewBag.enddate, payment = @ViewBag.payment, Store_val = @ViewBag.Store_val, searchdashbord = @ViewBag.searchdashbord , RedairectFrom = "invoicereport",VendorName = @ViewBag.VendorName, AmtMaximum = @ViewBag.AmtMaximum, AmtMinimum = @ViewBag.AmtMinimum } )">@Html.Raw(item.Invoice_Number)</a></td>
                                            @{
                                                string store_id = @ViewBag.Storeidvalue;
                                            }
                                            @if (Roles.IsUserInRole("Administrator") && @store_id == "0")
                                            {
                                                <td class="fntlight" style="width:5%" class="text-align-center">@item.Storename</td>
                                            }
                                            <td style="width:10%;text-align:center" class="text-align-center">
                                                @wwwroot.Class.AdminSiteConfiguration.GetDateformat(Convert.ToString(item.Invoice_Date))
                                            </td>
                                            <td style="width:10%;text-align:right">

                                                @if (item.Type_id == 2)
                                                {
                                                    if (item.deptid == 0)
                                                    {
                                                        <span style="color:red"> - @Html.Raw("$ " + wwwroot.Class.AdminSiteConfiguration.PriceWithComma(Convert.ToString(item.TotalAmtByDept))) </span>
                                                    }
                                                    else
                                                    {
                                                        <span style="color:red"> - @Html.Raw("$ " + wwwroot.Class.AdminSiteConfiguration.PriceWithComma(Convert.ToString(item.Amt))) </span>
                                                    }
                                                }

                                                else
                                                {
                                                    if (item.deptid == 0)
                                                    {
                                                        @Html.Raw("$ " + wwwroot.Class.AdminSiteConfiguration.PriceWithComma(Convert.ToString(item.TotalAmtByDept)))
                                                    }
                                                    else
                                                    {
                                                        @Html.Raw("$ " + wwwroot.Class.AdminSiteConfiguration.PriceWithComma(Convert.ToString(item.Amt)))
                                                    }
                                                }
                                            </td>
                                            <td style="text-align:right" width="10%" class="text-align-center">
                                                @if (item.Status == "Approved")
                                                {
                                                    <span class="btn btn-success btn-xs
"><i class="fa fa-check"></i>Approved</span>@*btndisable*@
}
else if (item.Status == "Rejected")
{ <span class="btn btn-danger btn-xs
"><i class="fa fa-times"></i>Rejected</span>}@*btndisable*@
else if (item.Status == "On Hold")
{
    <span class="btn btn-warning btn-xs btndisable
"><i class="glyphicon glyphicon-pause" aria-hidden="true"></i>On Hold</span>
}
else if (item.Status == "Pending")
{
    var ToolTip = "";
    if (item.Tooltip == "Data Approver")
    {
        ToolTip = "Store Manager";
    }
    else if (item.Tooltip == "Back Office Manager")
    {
        ToolTip = "Data Approver";
    }
    else
    {

    }
    <span title="@ToolTip" class="btn btn-warning btn-xs btnpending clsstatus"><i class="fa fa-minus" aria-hidden="true"></i> Pending</span>

}

                                            </td>

                                            @*
                                                <td>@Html.Raw(item.Storename)</td>*@
                                            <td style="width:10%" class="text-align-center"> @Html.Raw(item.Payment_type) </td>


                                            @if ((Roles.IsUserInRole("Administrator")) || (Roles.IsUserInRole("Back Office Manager")) || (Roles.IsUserInRole("Data Approver")))
                                            {

                                                <td style="vertical-align:middle;text-align:center;width:5%;display:none" class="printarea">
                                                    <input type="hidden" id="ID" name="ID" value="@item.id" />
                                                    <input type="hidden" id="ID" name="ID" value="@item.Store_id" />

                                                    @{
                                                        var UserIdD = @item.id + "D";
                                                    }
                                                    @if ((Roles.IsUserInRole("Back Office Manager")) || (Roles.IsUserInRole("Data Approver")))
                                                    {
                                                        if (item.IsStatus_id != 2 && item.IsStatus_id != 3)
                                                        {
                                                            <a href="#" onclick="return ComfirmDelete(@item.id);" data-toggle="tooltip" data-placement="top" data-original-title="Delete"><img src="~/Content/Admin/images/icon_delete.png" alt="" /> </a>
                                                            <a href="@Url.Action("Edit", "InvoiceReport", new { Id = item.id })" data-toggle="tooltip" data-placement="top" data-original-title="Edit"><img src="~/Content/Admin/images/icons/icon_iconedit.png" alt="" /></a>
                                                        }
                                                    }
                                                    else if (Roles.IsUserInRole("Administrator"))
                                                    {
                                                        if (item.IsStatus_id != 2 && item.IsStatus_id != 3)
                                                        {
                                                            <a href="#" onclick="return ComfirmDelete(@item.id);" data-toggle="tooltip" data-placement="top" data-original-title="Delete"><img src="~/Content/Admin/images/icon_delete.png" alt="" /> </a>
                                                            <a href="@Url.Action("Edit", "InvoiceReport", new { Id = item.id })" data-toggle="tooltip" data-placement="top" data-original-title="Edit"><img src="~/Content/Admin/images/icons/icon_iconedit.png" alt="" /></a>
                                                        }
                                                    }
                                                    <div id="@UserIdD" class="divIDClass modal-popup modal-danger modal-message min_with" style="position: fixed;  left:45%; width:300px; top: 10px; display:none">
                                                        <div class="modal-content ">
                                                            <div class="modal-header text-center">
                                                                <i class="glyphicon glyphicon-trash"></i>
                                                            </div>
                                                            <div class="modal-title">Message</div>
                                                            <div class="modal-body ">Are you sure want to delete this Invoice?</div>
                                                            <div class="modal-footer" style="text-align:center">
                                                                <a class="btn btn-danger" onclick="Delete(@item.id);">Ok </a>
                                                                <a class="btn" data-dismiss="modal" onclick="closemodal()">Cancel</a>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </td>

                                            }
                                            <td style="width:10%;text-align:center" class="text-align-center">
                                                @wwwroot.Class.AdminSiteConfiguration.GetDateformat(Convert.ToString(item.CreatedOn))
                                            </td>
                                        </tr>
                                    }

                                    <tr class="invoicetotalcountbox">
                                        <td colspan="2"><h1>Invoice  Total</h1></td>
                                        <td colspan="2" class="invoiceamt"><span>Invoice </span>$ @wwwroot.Class.AdminSiteConfiguration.PriceWithComma(Convert.ToString(ViewBag.TotalInvoiceType)) <span class="dashline">-</span></td>
                                        <td colspan="2" class="cashamt"><span>Credit Memo </span> $  @wwwroot.Class.AdminSiteConfiguration.PriceWithComma(Convert.ToString(ViewBag.TotalCreditMemo)) </td>
                                        <td colspan="3" class="totalamt">
                                            <span class="dashline">=</span> <span>Total </span>
                                            @{ var total1 = ViewBag.TotalInvoiceType - ViewBag.TotalCreditMemo;}
                                            @{
                                                if (ViewBag.TotalInvoiceType < ViewBag.TotalCreditMemo)
                                                {

                                                    <span style="font-size:25px !important">- $ @wwwroot.Class.AdminSiteConfiguration.PriceWithComma(Convert.ToString(((total1) * (-1))))</span>
                                                }
                                                else
                                                {
                                                    @wwwroot.Class.AdminSiteConfiguration.PriceWithComma(Convert.ToString(total1))
                                                }
                                            }

                                        </td>


                                    </tr>

                                }

                                <tr class="paginationGrid">
                                    <td class="left-text dataTables_length showdata" colspan="3" style="padding-top: 0px!important;">

                                        <div class="recordbox showingrecords">

                                            <span class="selectbox">
                                                @{
                                                    List<SelectListItem> listItem_Records = new List<SelectListItem>();
                                                    string[] Records = wwwroot.Class.AdminSiteConfiguration.GetArrayForRecordReport().ToString().Split(',');
                                                    foreach (string word in Records)
                                                    {
                                                        listItem_Records.Add(new SelectListItem
                                                        {
                                                            Text = word.Split(':')[0],
                                                            Value = word.Split(':')[1]
                                                        });
                                                    }

                                                    @Html.DropDownList("SelectRecords", listItem_Records, new { @class = "myval", @onchange = "javascript:FunPageRecord(this.value);" })
                                                }
                                            </span><span class="text_record">Records</span>
                                        </div>
                                        <div class="showdatabox showdataboxrecord">
                                            <span style="float:left">Showing @ViewBag.startIndex to @ViewBag.endIndex of @ViewBag.TotalDataCount entries</span>
                                        </div>

                                    </td>
                                    <td colspan="6">

                                        <div class="pagination">
                                            @if (ViewBag.LastPageIndex > 1)
                                            {
                                                if (ViewBag.CurrentPageIndex != 1)
                                                {
                                                    <a id="btnPageFirst" style="cursor:pointer" onclick="javascript:FunPageIndex(1);" class=" Linkbutton firstpage nextbtn">First</a>
                                                    <a id="btnPagePrevious" style="cursor:pointer" onclick="javascript:FunPageIndex(@ViewBag.CurrentPageIndex    -1);" class=" Linkbutton Linkbutton prebtn">Previous</a>
                                                }
                                                int PageIndex = 3;
                                                int StartPageIndex = ViewBag.CurrentPageIndex - PageIndex;//10-3=7
                                                int EndPageIndex = ViewBag.CurrentPageIndex + PageIndex;//10+3=13

                                                if (StartPageIndex < 1)
                                                {
                                                    EndPageIndex = EndPageIndex - StartPageIndex;
                                                }

                                                if (EndPageIndex > ViewBag.LastPageIndex)
                                                {
                                                    StartPageIndex = (StartPageIndex - (EndPageIndex - ViewBag.LastPageIndex)) + 1;
                                                }

                                                for (int i = 1; i <= @ViewBag.LastPageIndex; i++)
                                                {

                                                    if ((StartPageIndex < i && EndPageIndex > i))
                                                    {
                                                        if (ViewBag.CurrentPageIndex == i)
                                                        {
                                                            <span Style="min-width: 25px; display: inline-block;">@i          </span>
                                                        }
                                                        else
                                                        {
                                                            <a id="btnnum" style="cursor:pointer" onclick="javascript:FunPageIndex(@i);">@i</a>
                                                        }
                                                    }
                                                }
                                                if (ViewBag.CurrentPageIndex != @ViewBag.LastPageIndex)
                                                {
                                                    <a id="btnPageNext" style="cursor:pointer" onclick="javascript:FunPageIndex(@ViewBag.CurrentPageIndex    +1);" class=" Linkbutton nextbtn">Next</a>
                                                    <a id="btnPageLast" style="cursor:pointer" onclick="javascript:FunPageIndex(@ViewBag.LastPageIndex);" class=" Linkbutton lastpage nextbtn">Last</a>
                                                }
                                            }
                                        </div>
                                    </td>
                                </tr>
                            </tbody>

                        </table>
                    </div>
                </div>

            }
        }
    </div>
</div>
</div>


<script>

    $(".decimalOnly").bind('keypress', function isNumberKey(evt) {
        var charCode = (evt.which) ? evt.which : event.keyCode
        if (charCode > 31 && (charCode < 48 || charCode > 57) && charCode != 46)
            return false;

        return true;
    });
    $(".decimalOnly").bind("paste", function (e) {
        e.preventDefault();
    });

    $(document).ready(function () {
        //alert();
        $('#Validation').hide();
        $('#txtstartdate').attr('autocomplete', 'off');
        $('#txtenddate').attr('autocomplete', 'off');
        Loader(0);

        $('#txtstartdate').datetimepicker({
            format: 'MM/DD/YYYY',
            useCurrent: false
        });
        $('#txtenddate').datetimepicker({
            format: 'MM/DD/YYYY',
            useCurrent: false
        });

        $('#txtstartdate').on("dp.change", function (e) {
            $('#txtenddate').data("DateTimePicker").minDate(e.date);
        });
        $('#txtenddate').click("dp.change", function (e) {
            $('#txtenddate').data("DateTimePicker").minDate($('#txtstartdate').val());
        });

        //$('#txtstartdate').on("dp.change", function (e) {
        //    $('#txtenddate').data("DateTimePicker").minDate(e.date);
        //});
        //$('#txtenddate').click("dp.change", function (e) {

        //    $('#txtenddate').data("DateTimePicker").minDate($('#txtstartdate').val());
        //});
        document.getElementsByName('radio').value  = '@ViewBag.payment';
        bind()


    });

    function Minimum() {
        var Min = document.getElementById('AmtMinimum').value;
        var Max = document.getElementById('AmtMaximum').value;
        if (Min > Max) {
            //$('#Validation').show();
           // $('#AmtMaximum').val('');
            //$("#btnSearch").attr("style", "display:none;")
        }
        //$('#Validation').hide();
        //$("#btnSearch").removeAttr("style", "display:none;")
    }

    function Maximum() {
        var Min = document.getElementById('AmtMinimum').value;
        var Max = document.getElementById('AmtMaximum').value;
        if (Min > Max) {
            //$('#Validation').show();
          //  $('#AmtMaximum').val('');
            //$("#btnSearch").attr("style", "display:none;")
        }
        //$('#Validation').hide();
        //$("#btnSearch").removeAttr("style", "display:none;")
    }
    var top=0;
    function Loader(val) {
        var doc = document.documentElement;
        $("[data-toggle=tooltip]").tooltip();
        if (val == 1) {
            $(".loading-container").attr("style", "display:block;")
        }
        else {
            $(".loading-container").attr("style", "display:none;")
        }
        bind();
    }

    function FunSearchRecord()//Search
    {
        //var chk;
        //$('[name="radio"]:checked').each(function () {

        //    chk=$(this).val();


        //});

        var chk;
        var chkArray = [];
        $(".chk:checked").each(function() {
            chkArray.push($(this).val());


        });

        if(chkArray.length>1)
        {

            chk='';

        }
        if(chkArray.length==1)
        {

            chk=chkArray.toString();


        }
        //alert(chkArray.length+" length");
        //var selected;
        //selected=chkArray.toString();
        //alert("You have selected " + selected);
        //selected = chkArray.join(',') ;
        //if(chkArray.length > 0){
        //    alert("You have selected " + selected);
        //}else{
        //    alert("Please at least check one of the checkbox");
        //}

        window.FunSearchRecord=FunSearchRecord
        //  var element_txtSearchTitle = document.getElementById('txtSearchTitle').value;
        var element_dept = document.getElementById('DrpLstdept').value;
        var element_txtstartdate = document.getElementById('txtstartdate').value;
        var element_txtenddate = document.getElementById('txtenddate').value;
        var element_Status = document.getElementById('Drpstatus').value;
        var element_chkpayment=chk;
        var element_VendorName = document.getElementById('VendorName').value;
        var element_AmtMaximum = document.getElementById('AmtMaximum').value;
        var element_AmtMinimum = document.getElementById('AmtMinimum').value;
        @*var element_Store;

            var role = '@Roles.IsUserInRole("Data Approver")';

            if (role == 'True') {
                var store = $("#drp").val();
                element_Store=store;
            }
            else {
                var storename = $('#spnStore').html();
                element_Store=storename;
            }*@
        GetData(1, 1, '@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize, '', '', element_dept, element_txtstartdate, element_txtenddate, element_chkpayment, '', element_Status, element_VendorName, element_AmtMaximum, element_AmtMinimum);

    }

    function FunPageIndex(pageindex)//grid pagination
    {
        GetData(0, pageindex, '@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize, '@ViewBag.Alpha',@ViewBag.SearchRecords, '@ViewBag.deptname', '@ViewBag.startdate', '@ViewBag.enddate', '@ViewBag.payment', '@ViewBag.Store_val', '@ViewBag.Status', '@ViewBag.VendorName', '@ViewBag.AmtMaximum','@ViewBag.AmtMinimum');
    }

    function FunSortData(SortData)//Grid header sorting
    {
        GetData(0,@ViewBag.CurrentPageIndex, SortData,@ViewBag.AscVal,@ViewBag.PageSize,'@ViewBag.Alpha',@ViewBag.SearchRecords,'@ViewBag.deptname','@ViewBag.startdate','@ViewBag.enddate','@ViewBag.payment','@ViewBag.Store_val','@ViewBag.Status','@ViewBag.VendorName', '@ViewBag.AmtMaximum','@ViewBag.AmtMinimum');
    }

    function FunPageRecord(PageRecord)//Grid Page per record
    {
        GetData(0,1, '@ViewBag.OrderByVal',@ViewBag.IsAscVal,PageRecord,'@ViewBag.Alpha',@ViewBag.SearchRecords,'@ViewBag.deptname','@ViewBag.startdate','@ViewBag.enddate','@ViewBag.payment','@ViewBag.Store_val','@ViewBag.Status','@ViewBag.VendorName', '@ViewBag.AmtMaximum','@ViewBag.AmtMinimum');
    }

    function FunAlphaSearchRecord(alpha)//Alpha Search
    {
        GetData(1,1,'@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize,alpha,@ViewBag.SearchRecords,'@ViewBag.deptname','@ViewBag.startdate','@ViewBag.enddate','@ViewBag.payment','@ViewBag.Store_val','@ViewBag.Status','@ViewBag.VendorName', '@ViewBag.AmtMaximum','@ViewBag.AmtMinimum');
    }
    function ComfirmDelete(ID)
    {
        var DivId="#"+ID+"D";
        $(DivId).show();
        @*var check = confirm("Are you sure you want to Delete this record?");
        if (check == true) {
            Delete(ID);
            GetData(1,@ViewBag.CurrentPageIndex,  '@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize,'@ViewBag.Alpha',@ViewBag.SearchRecords,'@ViewBag.SearchTitle');
            return true;
        }
        else {
            return false;
        }*@
    }
    @*function ComfirmDelete(ID)
    {
        var check = confirm("Are you sure you want to Delete this Invoce?");
        if (check == true) {
            Delete(ID);
            GetData(1,@ViewBag.CurrentPageIndex,  '@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize,'@ViewBag.Alpha',@ViewBag.SearchRecords,'@ViewBag.deptname','@ViewBag.startdate','@ViewBag.enddate','@ViewBag.payment','@ViewBag.Store_val','@ViewBag.Status');
            return true;

        }
        else {
            return false;
        }

    }*@


    //For Search Button
    function GetData(IsBindData_val, PageIndex, orderby_val, isAsc_val, PageSize_val, alpha_val, SearchRecords_val, dept_val, startdate_val, enddate_val, payment_val, Store_val, Status_val, VendorName_Val, AmtMaximum_val, AmtMinimum_val)
    {

        $.ajax({
            url: '@wwwroot.Class.AdminSiteConfiguration.GetURL()/Admin/InvoiceReport/grid',
            data: { IsBindData: IsBindData_val, currentPageIndex: PageIndex, orderby: orderby_val.trim(), IsAsc: isAsc_val, PageSize: PageSize_val, SearchRecords: SearchRecords_val, Alpha: alpha_val, deptname: dept_val, startdate: startdate_val, enddate: enddate_val, payment: payment_val, Store_val: Store_val, Status: Status_val, VendorName: VendorName_Val, AmtMaximum: AmtMaximum_val, AmtMinimum: AmtMinimum_val},
            beforeSend: function () { Loader(1); },
            // async: false,
            success: function (response) {
                //    $("body").html(response);
                //alert(response)
                $('#grddata').empty();
                $('#grddata').append(response);
                Loader(0);
                @*var pay='@ViewBag.payment';
           alert(pay)*@

                if(payment_val=="Cash")
                {

                    $( "#radio1").prop('checked', true);
                }
                else if(payment_val=="Check/ACH")
                {
                    $( "#radio2").prop('checked', true);
                }
                else if(payment_val=="")
                {
                    $( "#radio1").prop('checked', true);
                    $( "#radio2").prop('checked', true);
                }
            },
            error:function()
            {
                Loader(0);
            }
        });

    }


    //document.getElementById('txtSearchTitle').onkeypress=function(e){
    //    if(e.keyCode==13){
    //        document.getElementById('btnSearch').click();
    //    }
    //}
    function bind(){

        $(".myval").select2({
            //placeholder: "select",
            allowclear: true,
            //minimumResultsForSearch: -1
        });
        if(document.getElementById('SelectRecords')!=null)
        {
            document.getElementById('SelectRecords').value = @ViewBag.PageSize;
        }


        // document.getElementById('txtSearchTitle').value = "@ViewBag.SearchTitle";

        $(".select2-container").remove();

        var pay='@ViewBag.payment';
        //alert(pay)

        if(pay=="Cash")
        {
            $( "#radio1").prop('checked', true);
        }
        else if(pay=="Check/ACH")
        {
            $( "#radio2").prop('checked', true);
        }
        //else if(pay=="")
        //{
        //    $( "#radio1").prop('checked', true);
        //    $( "#radio2").prop('checked', true);
        //}
        var dept=@ViewBag.deptname;
        if(dept!='0')
        {
            document.getElementById('DrpLstdept').value = @ViewBag.deptname;
        }
        document.getElementById('txtstartdate').value = "@ViewBag.startdate";
        document.getElementById('txtenddate').value = "@ViewBag.enddate";
        var Vender=@ViewBag.VendorName;
        if (Vender!='0')
        {
            document.getElementById('VendorName').value = @ViewBag.VendorName;
        }
        var AmtMinimum=@ViewBag.AmtMinimum;
        if (AmtMinimum != '0')
        {
            document.getElementById('AmtMinimum').value = "@ViewBag.AmtMinimum";
        }
        var AmtMaximum=@ViewBag.AmtMaximum;
        if (AmtMaximum != '0')
        {
            document.getElementById('AmtMaximum').value = "@ViewBag.AmtMaximum";
        }

        var statusid=@ViewBag.Status;
        if(statusid!='0')
        {
            document.getElementById('Drpstatus').value = @ViewBag.Status;
        }


        // $("#radio").val('@ViewBag.payment');
        $("select").select2({
            width: "100%",
            formatResult: function (state) {
                if (!state.id) return state.text;
                if ($(state.element).data('active') == "0") {
                    return state.text + "<i class='fa fa-dot-circle-o'></i>";
                } else {
                    return state.text;
                }
            },
            formatSelection: function (state) {
                if ($(state.element).data('active') == "0") {
                    return state.text + "<i class='fa fa-dot-circle-o'></i>";
                } else {
                    return state.text;
                }
            }
        });
        if(document.getElementById('SelectRecords')!=null)
        {
            document.getElementById('SelectRecords').value = @ViewBag.PageSize;
        }
    }



    function Delete(ID)
    {
        $.ajax({
            url: '@wwwroot.Class.AdminSiteConfiguration.GetURL()/admin/InvoiceReport/delete',
            data: { Id: ID},
            async: false,
            success: function (response) {
                GetData(1,@ViewBag.CurrentPageIndex,'@ViewBag.OrderByVal',@ViewBag.IsAscVal,@ViewBag.PageSize,'@ViewBag.Alpha',@ViewBag.SearchRecords,'@ViewBag.deptname','@ViewBag.startdate','@ViewBag.enddate','@ViewBag.payment','@ViewBag.Store_val','@ViewBag.Status','@ViewBag.VendorName', '@ViewBag.AmtMaximum','@ViewBag.AmtMinimum');
                return true;
            },
            error:function()
            {
                Loader(0);
            }
        });
    }
    function closemodal(){
        $(".divIDClass").hide();
        //$(".overlaybox").hide();
    }
</script>
